#!/usr/bin/env bash
set -euo pipefail

element_ws="name:element"
element_name="element"

active_name=""
if json="$(hyprctl -j activeworkspace 2>/dev/null)"; then
  if command -v jq >/dev/null 2>&1; then
    active_name="$(printf '%s' "$json" | jq -r '.name // empty')"
  else
    active_name="$(printf '%s' "$json" | sed -n 's/.*"name":"\\([^"]*\\)".*/\\1/p')"
  fi
fi

if [[ -z "$active_name" ]]; then
  active_name="$(hyprctl activeworkspace 2>/dev/null | sed -n 's/.*(\\(.*\\)).*/\\1/p' | head -n1)"
fi

if [[ "$active_name" == "$element_name" || "$active_name" == "$element_ws" ]]; then
  hyprctl dispatch workspace previous
else
  hyprctl dispatch moveworkspacetomonitor "$element_ws" current
  hyprctl dispatch workspace "$element_ws"
fi
